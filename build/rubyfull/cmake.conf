set(rubyfull_version "3.0.0")
set(rubyfull_download_command git clone https://github.com/Scorbutics/ruby-for-android5.git rubyfull-${rubyfull_version})
set(rubyfull_extract_command cp -r ${CMAKE_SOURCE_DIR}/download/rubyfull-${rubyfull_version} ./)
set(rubyfull_configure_command ./configure )
set(rubyfull_build_command cmake --build .)
set(rubyfull_install_command 
    cp -r `pwd`/target/usr/* ${CMAKE_SOURCE_DIR}/target/usr/ && 
    cp -r `realpath ${CMAKE_SOURCE_DIR}/target/usr/local/include/ruby-${rubyfull_version}/${CMAKE_LIBRARY_ARCHITECTURE}-*`/* ${CMAKE_SOURCE_DIR}/target/usr/local/include/ &&
    cp -r ${CMAKE_SOURCE_DIR}/target/usr/local/include/ruby-${rubyfull_version}/* ${CMAKE_SOURCE_DIR}/target/usr/local/include/ &&
    rm -r ${CMAKE_SOURCE_DIR}/target/usr/local/include/ruby-${rubyfull_version} &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libruby.so ${CMAKE_SOURCE_DIR}/target/usr/local/lib/libruby.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libgdbm.so ${CMAKE_SOURCE_DIR}/target/usr/local/lib/libgdbm.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libgdbm_compat.so ${CMAKE_SOURCE_DIR}/target/usr/local/lib/libgdbm_compat.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libreadline.so ${CMAKE_SOURCE_DIR}/target/usr/local/lib/libreadline.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libssl.so ${CMAKE_SOURCE_DIR}/target/usr/local/lib/libssl.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libcrypto.so ${CMAKE_SOURCE_DIR}/target/usr/local/lib/libcrypto.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libhistory.so ${CMAKE_SOURCE_DIR}/target/usr/local/lib/libhistory.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libcurses.so ${CMAKE_SOURCE_DIR}/target/usr/lib/libcurses.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libform.so ${CMAKE_SOURCE_DIR}/target/usr/lib/libform.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libmenu.so ${CMAKE_SOURCE_DIR}/target/usr/lib/libmenu.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libncurses.so ${CMAKE_SOURCE_DIR}/target/usr/lib/libncurses.so &&
    ${CMAKE_SOURCE_DIR}/target/host/usr/local/bin/patchelf --set-soname libpanel.so ${CMAKE_SOURCE_DIR}/target/usr/lib/libpanel.so
)

add_custom_target(rubyfull)
